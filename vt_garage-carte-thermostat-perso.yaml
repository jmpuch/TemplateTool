type: vertical-stack
cards:
  - type: heading
    icon: ""
    heading_style: title
    heading: Garage
  - type: custom:stack-in-card
    mode: horizontal
    cards:
      - show_name: true
        name: Garage
        show_icon: true
        type: custom:button-card
        entity: climate.vt_garage
        section_mode: true
        size: 20%
        icon: mdi:radiator
        tap_action:
          action: perform-action
          perform_action: climate.toggle
          target:
            entity_id:
              - climate.vt_garage
      - type: entity
        entity: sensor.ext
        name: Exterieur
        icon: mdi:home-thermometer-outline
  - type: custom:vertical-stack-in-card
    cards:
      - type: custom:mini-graph-card
        entities:
          - entity: sensor.vt_garage_ema_temperature
            name: Température
            state_adaptive_color: true
          - entity: climate.vt_garage
            name: Temp
            attribute: current_temperature
            unit: °C
            state_adaptive_color: true
            show_graph: false
            show_state: true
        hour24: true
        hours_to_show: 24
        points_per_hour: 2
        font_size: 50
        show:
          name: false
          icon: false
          legend: false
          labels: true
          extrema: false
        color_thresholds:
          - color: "#33ccff"
            value: 17.5
          - color: "#00ffff"
            value: 18
          - color: "#33ffcc"
            value: 18.5
          - color: "#00ff99"
            value: 19
          - color: "#ffff99"
            value: 19.5
          - color: "#ffff33"
            value: 20
          - color: "#ff9933"
            value: 20.5
          - color: "#cc6633"
            value: 21
          - color: "#ff6000"
            value: 23
      - type: custom:stack-in-card
        mode: horizontal
        cards:
          - type: custom:button-card
            name: hgel.
            entity: climate.vt_garage
            show_state: false
            show_icon: true
            show_name: false
            icon: mdi:snowflake
            size: 80%
            styles:
              icon:
                - color: |
                    [[[
                      if (states['climate.vt_garage']) {
                      if (states['climate.vt_garage'].attributes.is_on && states['climate.vt_garage'].attributes.preset_mode == 'frost')
                        return 'skyblue';
                      else
                        return 'white'; }
                    ]]]
              name:
                - color: white
                - font-size: 60%
              card:
                - height: 40px
                - width: 30px
            tap_action:
              action: perform-action
              perform_action: climate.set_preset_mode
              target:
                entity_id:
                  - climate.vt_garage
              data:
                preset_mode: frost
          - type: custom:button-card
            name: Eco
            entity: climate.vt_garage
            show_state: false
            show_icon: true
            show_name: false
            icon: mdi:leaf
            size: 80%
            styles:
              icon:
                - color: |
                    [[[
                      if (states['climate.vt_garage']) {
                      if (states['climate.vt_garage'].attributes.is_on && states['climate.vt_garage'].attributes.preset_mode == 'eco')
                        return 'lightgreen';
                      else
                        return 'white'; }
                    ]]]
              name:
                - color: white
                - font-size: 60%
              card:
                - height: 40px
                - width: 30px
            tap_action:
              action: perform-action
              perform_action: climate.set_preset_mode
              target:
                entity_id:
                  - climate.vt_garage
              data:
                preset_mode: eco
          - type: custom:button-card
            name: Conf.
            entity: climate.vt_garage
            show_state: false
            show_icon: true
            show_name: false
            icon: mdi:fire
            size: 80%
            styles:
              icon:
                - color: |
                    [[[
                      if (states['climate.vt_garage']) {
                      if (states['climate.vt_garage'].attributes.is_on && states['climate.vt_garage'].attributes.preset_mode == 'comfort')
                        return 'darkorange';
                      else
                        return 'white'; }
                    ]]]
              name:
                - color: white
                - font-size: 60%
              card:
                - height: 40px
                - width: 30px
            tap_action:
              action: perform-action
              perform_action: climate.set_preset_mode
              target:
                entity_id:
                  - climate.vt_garage
              data:
                preset_mode: comfort
          - type: custom:button-card
            name: Boost
            entity: climate.vt_garage
            show_state: false
            show_icon: true
            show_name: false
            icon: mdi:rocket-launch
            size: 80%
            styles:
              icon:
                - color: |
                    [[[
                      if (states['climate.vt_garage']) {
                      if (states['climate.vt_garage'].attributes.is_on && states['climate.vt_garage'].attributes.preset_mode == 'boost')
                        return 'red';
                      else
                        return 'white'; }
                    ]]]
              name:
                - color: white
                - font-size: 60%
              card:
                - height: 40px
                - width: 30px
            tap_action:
              action: perform-action
              perform_action: climate.set_preset_mode
              target:
                entity_id:
                  - climate.vt_garage
              data:
                preset_mode: boost
          - type: custom:button-card
            name: Manu
            entity: climate.vt_garage
            show_state: false
            show_icon: true
            show_name: false
            icon: mdi:hand-back-left
            size: 80%
            styles:
              icon:
                - color: |
                    [[[
                      if (states['climate.vt_garage']) {
                      if (states['climate.vt_garage'].attributes.is_on && states['climate.vt_garage'].attributes.preset_mode == 'none')
                        return 'indianred';
                      else
                        return 'white'; }
                    ]]]
              name:
                - color: white
                - font-size: 60%
              card:
                - height: 40px
                - width: 30px
            tap_action:
              action: perform-action
              perform_action: climate.set_preset_mode
              target:
                entity_id:
                  - climate.vt_garage
              data:
                preset_mode: none
      - type: custom:stack-in-card
        mode: horizontal
        cards:
          - type: horizontal-stack
            cards:
              - type: custom:button-card
                name: Pres
                entity: climate.vt_garage
                show_state: false
                show_icon: true
                show_name: false
                icon: mdi:home
                size: 80%
                styles:
                  icon:
                    - color: |
                        [[[
                          if (states['climate.vt_garage']) {
                          if (states['climate.vt_garage'].attributes.presence_state == 'on')
                            return 'green';
                          else
                            return 'white'; }
                        ]]]
                  name:
                    - color: white
                    - font-size: 60%
                  card:
                    - height: 40px
                    - width: 30px
              - type: custom:button-card
                name: Wind
                entity: climate.vt_garage
                show_state: false
                show_icon: true
                show_name: false
                icon: mdi:window-open-variant
                size: 80%
                styles:
                  icon:
                    - color: |
                        [[[
                          if (states['climate.vt_garage']) {
                          if (states['climate.vt_garage'].attributes.window_state == 'on')
                            return 'red';
                          else
                            return 'white'; }
                        ]]]
                  name:
                    - color: white
                    - font-size: 60%
                  card:
                    - height: 40px
                    - width: 30px
              - type: custom:mushroom-template-card
                secondary: ""
                layout: horizontal
                tap_action:
                  action: more-info
                entity: sensor.vt_garage_power_percent
                fill_container: false
                multiline_secondary: false
                primary: |
                  {% if (states['climate.vt_garage'].attributes.is_on) -%}
                      Power = {{ states('sensor.vt_garage_power_percent') }} %
                  {%- else -%}
                      Power off
                  {%- endif %}
                icon: ""
      - type: custom:mushroom-climate-card
        entity: climate.vt_garage
        show_temperature_control: true
        hvac_modes: []
        tap_action:
          action: more-info
        primary_info: state
        icon: mdi:fire
        secondary_info: last-updated
        fill_container: false
        layout: horizontal
